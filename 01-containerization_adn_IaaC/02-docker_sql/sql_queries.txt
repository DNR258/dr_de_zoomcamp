Question 3

SELECT COUNT(*) 
FROM green_taxi_data 
WHERE date_trunc('day', lpep_pickup_datetime) = '2019-09-18';


Question 4

SELECT date_trunc('day', lpep_pickup_datetime) AS pu_day, 
       MAX(trip_distance) AS max_distance
FROM green_taxi_data 
GROUP BY pu_day
ORDER BY max_distance DESC;


Question 5

SELECT "Borough",
       SUM(total_amount) AS grand_total_amount
FROM green_taxi_data AS td
LEFT JOIN zones AS z
   ON td."PULocationID" = z."LocationID" 
   AND date_trunc('day', lpep_pickup_datetime) = '2019-09-18' 
WHERE z."Borough" <> 'unknown'
GROUP BY z."Borough"
HAVING SUM(total_amount) > 50000
ORDER BY grand_total_amount DESC;


Question 6

SELECT zo."Zone" AS dropoff_zone,
       MAX(tip_amount) AS max_tip
FROM green_taxi_data AS td
LEFT JOIN zones AS zu
	ON td."PULocationID" = zu."LocationID" 
LEFT JOIN zones AS zo
	ON td."DOLocationID" = zo."LocationID" 
WHERE zu."Zone" = 'Astoria'
	AND LEFT(CAST(date_trunc('month', lpep_pickup_datetime) AS VARCHAR), 7) = '2019-09' 
GROUP BY zo."Zone"
ORDER BY max_tip DESC;
